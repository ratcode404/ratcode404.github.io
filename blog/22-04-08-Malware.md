[Back to Main Page](../index.html) 

# Malware Development

<img src="../img/blog-22-malwarebanner.PNG" width="1000">

## The basics

This blog will be focused on a github project in regards of development of malicious software. We will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.  For the purpose of this and following articles we will use MS Visual Studio on Windows 10.

To start things off, we will try to create a C++ application that run malicious shellcode, trying not to be caught by AV Software.  
Why C++ and not C# or PowerShell script? Because itâ€™s much more difficult to analyze compiled binary when compared to managed code or script.

### How detections work

Antimalware solutions are based on three types of detection mechanisms:

- Signature: inspection of file checksums (MD5, SH1,...) and presence of known strings and byte sequences in the binary
- Heuristic: application behavior and identification of characteristics (functions that are usually used in malware)
- Sandboxing: Analysis in a monitored environment

Multiple techniques to evade different mechanisms exist. For example:

- Polymorphic: To defeat signature-based detection (can also be at least multiple times recompiled).
- Obfuscation: Can evade heuristic based detection
- Conditional: Various statements that detect and bypass sandboxes
- Encoded Info: Encoding and encrypting sensitive information can help bypass signature-based detection as well as heuristic detection

### Generating Shellcode

First, we open up MS Visual Studio, and create a new project. We will be creating a Windows C++ Console Application (x86). We can use Metasploit to generate some malicious shellcode, for example a bind shell. Bind TCP opens up a port on the system and allows a connection from the remote attacking box. 

`msfvenom -p windows/shell_bind_tcp LPORT=4444 -f c`

